# ğŸ”€ @aiwaretop/claw-router

> **[OpenClaw](https://openclaw.app) æ™ºèƒ½æ¨¡å‹è·¯ç”±æ’ä»¶** â€” æ ¹æ®æ¶ˆæ¯å¤æ‚åº¦è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¨¡å‹ã€‚

[![AIWare Community License](https://img.shields.io/badge/license-AIWare%20Community%20License-blue.svg)](LICENSE)
[![OpenClaw Plugin](https://img.shields.io/badge/OpenClaw-plugin-purple.svg)](https://openclaw.app)

[English](README.md) | **ä¸­æ–‡**

---

## ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ

ä¸æ˜¯æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦æœ€å¼ºçš„æ¨¡å‹ã€‚"ä½ å¥½" ç”¨å¿«é€Ÿä¾¿å®œçš„æ¨¡å‹å°±å¤Ÿäº†ï¼Œè€Œ"è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿ" åˆ™éœ€è¦é¡¶çº§æ¨¡å‹æ¥å¤„ç†ã€‚**Claw Router** è‡ªåŠ¨å¸®ä½ åšè¿™ä¸ªå†³ç­– â€” çº¯æœ¬åœ°è®¡ç®—ï¼Œ< 1msï¼Œé›¶ API è°ƒç”¨ã€‚

```
ç”¨æˆ·: "ä½ å¥½"           â†’ TRIVIAL  â†’ doubao-seed-code    ï¼ˆå¿«é€Ÿã€ä¾¿å®œï¼‰
ç”¨æˆ·: "å†™ä¸ªçˆ¬è™«"        â†’ COMPLEX  â†’ gpt-5.3-codex-high ï¼ˆå¼ºåŠ›ï¼‰
ç”¨æˆ·: "è®¾è®¡åˆ†å¸ƒå¼æ¶æ„"    â†’ EXPERT   â†’ claude-opus-4      ï¼ˆæœ€å¼ºï¼‰
```

---

## æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·æ¶ˆæ¯                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ç¡¬è§„åˆ™æ£€æŸ¥    â”‚ â—„â”€â”€ çŸ­æ¶ˆæ¯ï¼Ÿ3+ä»£ç å—ï¼Ÿ
              â”‚  (< 0.01 ms)   â”‚     "ç³»ç»Ÿè®¾è®¡"ï¼Ÿ
              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ æ— åŒ¹é…
                      â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       8 ç»´è¯„åˆ†å¼•æ“                   â”‚
     â”‚                                     â”‚
     â”‚  æ¨ç†æ·±åº¦(0.20)  ä»£ç æŠ€æœ¯(0.18)       â”‚
     â”‚  ä»»åŠ¡æ­¥éª¤(0.15)  é¢†åŸŸä¸“ä¸š(0.12)       â”‚
     â”‚  è¾“å‡ºå¤æ‚(0.10)  åˆ›æ„è¦æ±‚(0.10)       â”‚
     â”‚  ä¸Šä¸‹æ–‡(0.08)    æ¶ˆæ¯é•¿åº¦(0.07)       â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Sigmoid æ ¡å‡†      â”‚
              â”‚   Î£(wáµ¢Â·sáµ¢) â†’ Ïƒ   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚           Tier æ˜ å°„                  â”‚
     â”‚  [0.00,0.15) â†’ TRIVIALï¼ˆæç®€ï¼‰        â”‚
     â”‚  [0.15,0.35) â†’ SIMPLEï¼ˆç®€å•ï¼‰         â”‚
     â”‚  [0.35,0.55) â†’ MODERATEï¼ˆä¸­ç­‰ï¼‰       â”‚
     â”‚  [0.55,0.75) â†’ COMPLEXï¼ˆå¤æ‚ï¼‰        â”‚
     â”‚  [0.75,1.00] â†’ EXPERTï¼ˆä¸“å®¶ï¼‰         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  é€‰æ‹©æ¨¡å‹       â”‚ â†’ ä¸»æ¨¡å‹ / å¤‡ç”¨æ¨¡å‹
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…

```bash
cd ~/.openclaw
npm install @aiwaretop/claw-router
```

### 2. å¯ç”¨æ’ä»¶

åœ¨ OpenClaw é…ç½®ä¸­æ·»åŠ ï¼ˆ`~/.openclaw/openclaw.json`ï¼‰ï¼š

```json
{
  "plugins": {
    "enabled": true,
    "allow": ["claw-router"],
    "entries": {
      "claw-router": {
        "enabled": true
      }
    }
  }
}
```

### 3. é…ç½®ï¼ˆå¯é€‰ï¼‰

**é‡è¦ï¼š** æ’ä»¶é…ç½®å¿…é¡»æ”¾åœ¨ `config` å­—æ®µä¸‹ï¼š

```json
{
  "plugins": {
    "entries": {
      "claw-router": {
        "enabled": true,
        "config": {
          "tiers": {
            "TRIVIAL":  { "primary": "volcengine/doubao-seed-code" },
            "SIMPLE":   { "primary": "volcengine/doubao-seed-code" },
            "MODERATE": { "primary": "api-proxy-gpt/gpt-5.3-codex-high" },
            "COMPLEX":  { "primary": "api-proxy-gpt/gpt-5.3-codex-high" },
            "EXPERT":   { "primary": "api-proxy-claude/claude-opus-4-6" }
          },
          "logging": true
        }
      }
    }
  }
}
```

---

## åŠŸèƒ½

### ğŸ¯ Agent å·¥å…·ï¼š`smart_route`

Agent å¯ä»¥è°ƒç”¨æ­¤å·¥å…·è·å–è·¯ç”±å»ºè®®ï¼š

```
å·¥å…·: smart_route
è¾“å…¥: { "message": "å¸®æˆ‘è®¾è®¡ä¸€ä¸ªåˆ†å¸ƒå¼ç¼“å­˜ç³»ç»Ÿ" }
è¾“å‡º: {
  "tier": "EXPERT",
  "model": "api-proxy-claude/claude-opus-4-6",
  "score": 0.8234,
  "dimensions": { "reasoning": 0.5, "codeTech": 0.65, ... }
}
```

### ğŸ’¬ è‡ªåŠ¨å›å¤å‘½ä»¤ï¼š`/route`

åœ¨èŠå¤©ä¸­è¾“å…¥ `/route` æŸ¥çœ‹è·¯ç”±çŠ¶æ€å’Œç»Ÿè®¡æ•°æ®ã€‚

### ğŸ–¥ï¸ CLI å‘½ä»¤

```bash
# æŸ¥çœ‹è·¯ç”±çŠ¶æ€
openclaw route status

# æµ‹è¯•æ¶ˆæ¯è·¯ç”±
openclaw route test "è¯·å¸®æˆ‘å†™ä¸€ä¸ªæ’åºç®—æ³•"
```

### ğŸ”Œ Gateway RPC

```javascript
await rpc('route.decide', { message: '...' });
await rpc('route.stats');
```

---

## é…ç½®å‚è€ƒ

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `tiers` | `Record<Tier, { primary, fallback? }>` | å…¨éƒ¨ `"default"` | æ¯ä¸ª Tier å¯¹åº”çš„æ¨¡å‹ |
| `thresholds` | `[n, n, n, n]` | `[0.15, 0.35, 0.55, 0.75]` | Tier åˆ†ç•Œé˜ˆå€¼ |
| `scoring.weights` | `Record<Dimension, number>` | è§ä¸‹è¡¨ | è¦†ç›–ç»´åº¦æƒé‡ |
| `logging` | `boolean` | `false` | å¯ç”¨è¯¦ç»†è·¯ç”±æ—¥å¿— |

### é»˜è®¤æƒé‡

| ç»´åº¦ | é”®å | æƒé‡ |
|------|------|------|
| æ¨ç†æ·±åº¦ | `reasoning` | 0.20 |
| ä»£ç /æŠ€æœ¯ | `codeTech` | 0.18 |
| ä»»åŠ¡æ­¥éª¤ | `taskSteps` | 0.15 |
| é¢†åŸŸä¸“ä¸šåº¦ | `domainExpert` | 0.12 |
| è¾“å‡ºå¤æ‚åº¦ | `outputComplex` | 0.10 |
| åˆ›æ„è¦æ±‚ | `creativity` | 0.10 |
| ä¸Šä¸‹æ–‡ä¾èµ– | `contextDepend` | 0.08 |
| æ¶ˆæ¯é•¿åº¦ | `messageLength` | 0.07 |

### ç¡¬è§„åˆ™ï¼ˆä¼˜å…ˆçº§é«˜äºè¯„åˆ†ï¼‰

| æ¡ä»¶ | ç»“æœ |
|------|------|
| æ¶ˆæ¯ â‰¤ 5 å­—ç¬¦ä¸”æ— æŠ€æœ¯è¯ | â†’ TRIVIAL |
| 3+ ä¸ªä»£ç å— (```) | â†’ COMPLEX |
| åŒ…å«"ç³»ç»Ÿè®¾è®¡""æ¶æ„è®¾è®¡""ä»é›¶æ­å»º" | â†’ EXPERT |

---

## è¯„åˆ†åŸç†

1. **å…³é”®è¯åŒ¹é…** â€” æ¯ä¸ªç»´åº¦æœ‰ä¸­è‹±æ–‡å…³é”®è¯åº“ã€‚åŒ¹é…ä½¿ç”¨ soft-max ç´¯ç§¯ï¼š`score = 1 - âˆ(1 - wáµ¢)`ï¼Œè‡ªç„¶è¶‹è¿‘äº 1.0ã€‚

2. **é•¿åº¦è¯„åˆ†** â€” å­—ç¬¦æ•°åˆ° 0-1 çš„åˆ†æ®µçº¿æ€§æ˜ å°„ã€‚

3. **åŠ æƒæ±‚å’Œ** â€” `rawSum = Î£(ç»´åº¦åˆ†æ•° Ã— æƒé‡)`

4. **Sigmoid æ ¡å‡†** â€” `calibrated = Ïƒ(rawSum)`ï¼Œå‚æ•° `k=4, midpoint=0.5`

5. **Tier æ˜ å°„** â€” æ ¡å‡†åçš„åˆ†æ•°é€šè¿‡é˜ˆå€¼æ˜ å°„åˆ°å¯¹åº” Tierã€‚

---

## å¼€å‘

```bash
git clone https://github.com/HackSing/claw-router.git
cd claw-router
npm install
npm test
```

---

## è®¸å¯è¯

[AIWare Community License](LICENSE) Â© aiwaretop
